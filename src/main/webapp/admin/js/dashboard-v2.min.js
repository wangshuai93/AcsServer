/***************************************************************************
 *                                                                         *
 * Auto Generated BY CodeComment                                           *
 * Copyright(C) 2000-2016, JiangSu Yinhe Electronic Co.Ltd.                *
 * All Rights Reserved.                                                    *
 * THIS IS UNPUBLISHED PROPRIETARY SOURCE CODE OF Yinhe Elec Co.Ltd.       *
 * The copyright notice above does not evidence any actual or intended     *
 * publication of such source code.                                        *
 *                                                                         *
 **************************************************************************/

/*   
Template Name: Color Admin - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.3.1
Version: 1.5.0
Author: Sean Ngu
Website: http://www.seantheme.com/color-admin-v1.5/admin/
*/


var getMonthName_EN = function(e) {
	var t = [];
	t[0] = "January";
	t[1] = "February";
	t[2] = "March";
	t[3] = "April";
	t[4] = "May";
	t[5] = "Jun";
	t[6] = "July";
	t[7] = "August";
	t[8] = "September";
	t[9] = "October";
	t[10] = "November";
	t[11] = "December";
	return t[e]
};

var getMonthName = function(e) {
	var t = [];
	t[0] = "1";
	t[1] = "2";
	t[2] = "3";
	t[3] = "4";
	t[4] = "5";
	t[5] = "6";
	t[6] = "7";
	t[7] = "8";
	t[8] = "9";
	t[9] = "10";
	t[10] = "11";
	t[11] = "12";
	return t[e]
};

var getDate = function(e) {
	var t = new Date(e);
	var n = t.getDate();
	var r = t.getMonth() + 1;
	var i = t.getFullYear();
	if (n < 10) {
		n = "0" + n
	}
	if (r < 10) {
		r = "0" + r
	}
	t = i + "-" + r + "-" + n;
	return t
};

var handleVisitorsLineChart = function() {
	
	var leastMonthRechargeConsume =document.getElementById("leastMonthRechargeConsumeList").value;
	//var span_servicecost=document.getElementById("span_servicecost");
	//var span_electricitycost=document.getElementById("span_electricitycost");
	var span_Needlecost = document.getElementById("span_Needlecost");
	var span_Peakcost = document.getElementById("span_Peakcost");
	var span_Smoothcost = document.getElementById("span_Smoothcost");
	var span_Valecost = document.getElementById("span_Valecost");
	
	var objlist = eval(leastMonthRechargeConsume);
	var dates = {};
	/*var totalConsumeMoneys = {};
	var totalConsumeMeters = {};*/
	var totalNeedleMoney = {};
	var totalPeakMoney = {};
	var totalSmoothMoney = {};
	var totalValeMoney = {};
	
	for(var i =0; i <objlist.length; i++)
		{
			dates[i] = new Date(objlist[i].date).format('yyyy-MM-dd');
			totalNeedleMoney[i]= objlist[i].totalNeedleMoney;
			totalPeakMoney[i]= objlist[i].totalPeakMoney; 
			totalSmoothMoney[i]= objlist[i].totalSmoothMoney;
			totalValeMoney[i]= objlist[i].totalValeMoney; 
			/*totalSmoothMoney[i]= (objlist[i].totalConsumeMoney -objlist[i].totalServiceCost).toFixed(2) ;
			totalValeMoney[i]= objlist[i].totalServiceCost; */
			
		}
	var n = "#FF5B57";
	var p = "#F59C1A";
	var s = "#00ACAC";
	var v = "#49B6D6";
	var e = "#0D888B";
	//var t = "#00ACAC";
	//var n = "#3273B1";
	//var r = "#348FE2";
	var i = "rgba(0,0,0,0.6)";
	//var s = "rgba(255,255,255,0.4)";
	Morris.Line({
		element: "visitors-line-chart",
		data: [{
			x: dates[7],
			y: totalNeedleMoney[7],
			z: totalPeakMoney[7],
			j: totalSmoothMoney[7],
			k: totalValeMoney[7]
		}, 		
		{
			x: dates[6],
			y: totalNeedleMoney[6],
			z: totalPeakMoney[6],
			j: totalSmoothMoney[6],
			k: totalValeMoney[6]
		}, {
			x: dates[5],
			y: totalNeedleMoney[5],
			z: totalPeakMoney[5],
			j: totalSmoothMoney[5],
			k: totalValeMoney[5]
		}, {
			x: dates[4],
			y: totalNeedleMoney[4],
			z: totalPeakMoney[4],
			j: totalSmoothMoney[4],
			k: totalValeMoney[4]
		}, {
			x: dates[3],
			y: totalNeedleMoney[3],
			z: totalPeakMoney[3],
			j: totalSmoothMoney[3],
			k: totalValeMoney[3]
		}, {
			x: dates[2],
			y: totalNeedleMoney[2],
			z: totalPeakMoney[2],
			j: totalSmoothMoney[2],
			k: totalValeMoney[2]
		}, {
			x: dates[1],
			y: totalNeedleMoney[1],
			z: totalPeakMoney[1],
			j: totalSmoothMoney[1],
			k: totalValeMoney[1]
		}, {
			x: dates[0],
			y: totalNeedleMoney[0],
			z: totalPeakMoney[0],
			j: totalSmoothMoney[0],
			k: totalValeMoney[0]
		}],
		xkey: "x",
		ykeys: ["y", "z", "j", "k"],
		xLabelFormat: function(e) {
			e = getMonthName(e.getMonth());
			return e.toString()
		},
		labels: [span_Needlecost.innerHTML, span_Peakcost.innerHTML, span_Smoothcost.innerHTML, span_Valecost.innerHTML],
		lineColors: [n, p, s, v],
		pointFillColors: [n, p, s, v],
		lineWidth: "2px",
		pointStrokeColors: [i, i, i, i],
		resize: true,
		gridTextFamily: "Open Sans",
		gridTextColor: s,
		gridTextWeight: "normal",
		gridTextSize: "11px",
		gridLineColor: "rgba(0,0,0,0.5)",
		hideHover: "auto"
	})
};

var handleVisitorsDonutChart = function() {
	var n = "#FF5B57";
	var p = "#F59C1A";
	var s = "#00ACAC";
	var v = "#49B6D6";
	var totalConsumeMoney =document.getElementById("totalConsumeMoney");
	
	var totalNeedleMoney = document.getElementById("totalNeedle");
	var totalPeakMoney = document.getElementById("totalPeak");
	var totalSmoothMoney = document.getElementById("totalSmooth");
	var totalValeMoney =document.getElementById("totalVale");
	
	var span_Needlecost = document.getElementById("span_Needlecost");
	var span_Peakcost = document.getElementById("span_Peakcost");
	var span_Smoothcost = document.getElementById("span_Smoothcost");
	var span_Valecost = document.getElementById("span_Valecost");

	Morris.Donut({
		element: "visitors-donut-chart",
		data: [{
			label: span_Needlecost.innerHTML,
			value: totalNeedleMoney.value
		}, {
			label: span_Peakcost.innerHTML,
			value: totalPeakMoney.value 
		},{
			label: span_Smoothcost.innerHTML,
			value: totalSmoothMoney.value 
		},{
			label: span_Valecost.innerHTML,
			value: totalValeMoney.value 
		}],
		colors: [n, p, s, v],
		labelFamily: "Open Sans",
		labelColor: "rgba(255,255,255,0.4)",
		labelTextSize: "12px",
		backgroundColor: "#242a30"
	})
};

Date.prototype.format =function(format)
{
	var o = {
	"M+" : this.getMonth()+1, //month
	"d+" : this.getDate(), //day
	"h+" : this.getHours(), //hour
	"m+" : this.getMinutes(), //minute
	"s+" : this.getSeconds(), //second
	"q+" : Math.floor((this.getMonth()+3)/3), //quarter
	"S" : this.getMilliseconds() //millisecond
	}
	if(/(y+)/.test(format)) format=format.replace(RegExp.$1,
	(this.getFullYear()+"").substr(4- RegExp.$1.length));
	for(var k in o)if(new RegExp("("+ k +")").test(format))
	format = format.replace(RegExp.$1,
	RegExp.$1.length==1? o[k] :
	("00"+ o[k]).substr((""+ o[k]).length));
	return format;
}

var DashboardV3 = function() {
	"use strict";
	return {
		init: function() {
			handleVisitorsDonutChart();
			handleVisitorsLineChart();
		}
	}
}()